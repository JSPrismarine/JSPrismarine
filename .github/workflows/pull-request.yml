name: PRs

on:
    pull_request:
        types: [opened, synchronize, labeled]

jobs:
    renovate:
        name: ğŸ” Update Lockfile & Add Changeset
        runs-on: ubuntu-latest
        if: contains(github.event.pull_request.labels.*.name, 'Dependency')

        permissions:
            contents: write
            pull-requests: write

        steps:
            - name: ğŸ•¶ï¸ Checkout repository
              uses: actions/checkout@v4
              with:
                  fetch-depth: 0
                  ref: ${{github.event.pull_request.head.ref}}
                  repository: ${{github.event.pull_request.head.repo.full_name}}
                  token: ${{ secrets.GITHUB_TOKEN }}
                  submodules: 'recursive'

            - name: ğŸ“¦ Install
              uses: ./.github/common/install

            - name: ğŸšš Update PR
              uses: mscharley/dependency-changesets-action@v1.1.7
              with:
                  use-conventional-commits: false
                  commit-message: 'Deps: Add changeset.'
                  token: ${{ secrets.GITHUB_TOKEN }}
